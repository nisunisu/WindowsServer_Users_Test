PS C:\Users\NormalUser> Get-LocalUser -Name NormalUser | Format-List # NormalUser??????????
>>


AccountExpires         :
Description            :
Enabled                : True
FullName               : hoge
PasswordChangeableDate : 2020/11/16 9:27:04
PasswordExpires        :
UserMayChangePassword  : True
PasswordRequired       : True
PasswordLastSet        : 2020/11/16 9:27:04
LastLogon              : 2020/11/16 11:27:45
Name                   : NormalUser
SID                    : S-1-5-21-1342186295-3794931512-398705387-1008
PrincipalSource        : Local
ObjectClass            : User



PS C:\Users\NormalUser> Get-LocalGroup -Name Users | Format-List # Users???????????
>>


Description     : Users are prevented from making accidental or intentional system-wide changes and can run most applic
                  ations
Name            : Users
SID             : S-1-5-32-545
PrincipalSource : Local
ObjectClass     : Group



PS C:\Users\NormalUser>
PS C:\Users\NormalUser> Get-LocalGroupMember -Name Users | Format-List # -> NormalUser?????
>>


Name            : EC2AMAZ-EL7HT5B\NormalUser
SID             : S-1-5-21-1342186295-3794931512-398705387-1008
PrincipalSource : Local
ObjectClass     : User

Name            : NT AUTHORITY\Authenticated Users
SID             : S-1-5-11
PrincipalSource : Unknown
ObjectClass     : Group

Name            : NT AUTHORITY\INTERACTIVE
SID             : S-1-5-4
PrincipalSource : Unknown
ObjectClass     : Group



PS C:\Users\NormalUser>
PS C:\Users\NormalUser> Get-Date
>>

2020年11月16日 12:54:42


PS C:\Users\NormalUser>
PS C:\Users\NormalUser> Get-WmiObject Win32_OperatingSystem # Windows????????
>>


SystemDirectory : C:\Windows\system32
Organization    : Amazon.com
BuildNumber     : 17763
RegisteredUser  : EC2
SerialNumber    : 00430-00000-00000-AA239
Version         : 10.0.17763



PS C:\Users\NormalUser>
PS C:\Users\NormalUser> whoami
>>
ec2amaz-el7ht5b\normaluser
PS C:\Users\NormalUser>
PS C:\Users\NormalUser>
PS C:\Users\NormalUser> $target_folders=@(
>>   "C:\PerfLogs"
>>   "C:\Program Files"
>>   "C:\Program Files (x86)"
>>   "C:\Windows"
>> )
>>
PS C:\Users\NormalUser>
PS C:\Users\NormalUser>
PS C:\Users\NormalUser>
PS C:\Users\NormalUser> # ?????
>> $target_folders | Foreach-Object {
>>   # ??????????????????
>>   $folders = Get-ChildItem -Path "$_" | ? {$_.PsIsContainer -eq $true}
>>   $folders | Foreach-Object {
>>     $folder_path = $_.FullName
>>     $acl = Get-Acl -Path $folder_path
>>     $acl_obj = $acl.Access |
>>       Where-Object {
>>         $_.IdentityReference -match "Users" -and
>>         $_.FilesyStemRights  -match "Read"
>>       }
>>     # ?????????????????
>>     Write-Output "$($acl_obj.IdentityReference) : $($acl_obj.FilesyStemRights) : $($_.FullName)"
>>   }
>> }
Get-ChildItem : Access to the path 'C:\PerfLogs' is denied.
At line:4 char:14
+   $folders = Get-ChildItem -Path "$_" | ? {$_.PsIsContainer -eq $true ...
+              ~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : PermissionDenied: (C:\PerfLogs:String) [Get-ChildItem], UnauthorizedAccessException
    + FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.PowerShell.Commands.GetChildItemCommand

BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files\Amazon
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files\Common Files
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files\internet explorer
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files\Windows Defender
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files\Windows Defender Advanced Threat Protection
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files\Windows Mail
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files\Windows Media Player
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files\Windows Multimedia Platform
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files\windows nt
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files\Windows Photo Viewer
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files\Windows Portable Devices
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files\Windows Security
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files\WindowsPowerShell
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files (x86)\AWS SDK for .NET
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files (x86)\AWS Tools
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files (x86)\Common Files
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files (x86)\Internet Explorer
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files (x86)\Microsoft.NET
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files (x86)\Windows Defender
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files (x86)\Windows Mail
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files (x86)\Windows Media Player
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files (x86)\Windows Multimedia Platform
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files (x86)\windows nt
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files (x86)\Windows Photo Viewer
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files (x86)\Windows Portable Devices
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Program Files (x86)\WindowsPowerShell
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\ADFS
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\appcompat
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\apppatch
NT AUTHORITY\Authenticated Users : Read, Synchronize : C:\Windows\AppReadiness
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\assembly
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\bcastdvr
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\Boot
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\Branding
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\CbsTemp
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\Containers
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\Cursors
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\debug
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\diagnostics
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\DigitalLocker
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\Downloaded Program Files
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\drivers
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\en-US
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\Fonts
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\Globalization
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\Help
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\IdentityCRL
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\IME
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\ImmersiveControlPanel
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\INF
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\InputMethod
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\ja-JP
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\L2Schemas
Get-Acl : Attempted to perform an unauthorized operation.
At line:7 char:12
+     $acl = Get-Acl -Path $folder_path
+            ~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Get-Acl], UnauthorizedAccessException
    + FullyQualifiedErrorId : System.UnauthorizedAccessException,Microsoft.PowerShell.Commands.GetAclCommand

BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\LiveKernelReports
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\Logs
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\media
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\Microsoft.NET
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\Migration
Get-Acl : Attempted to perform an unauthorized operation.
At line:7 char:12
+     $acl = Get-Acl -Path $folder_path
+            ~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Get-Acl], UnauthorizedAccessException
    + FullyQualifiedErrorId : System.UnauthorizedAccessException,Microsoft.PowerShell.Commands.GetAclCommand

BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\ModemLogs
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\OCR
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\Offline Web Pages
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\Panther
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\Performance
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\PLA
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\PolicyDefinitions
Get-Acl : Attempted to perform an unauthorized operation.
At line:7 char:12
+     $acl = Get-Acl -Path $folder_path
+            ~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Get-Acl], UnauthorizedAccessException
    + FullyQualifiedErrorId : System.UnauthorizedAccessException,Microsoft.PowerShell.Commands.GetAclCommand

BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\Prefetch
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\PrintDialog
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\Provisioning
 :  : C:\Windows\Registration
NT AUTHORITY\Authenticated Users BUILTIN\Users : ReadAndExecute, Synchronize ReadAndExecute, Synchronize : C:\Windows\RemotePackages
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\rescache
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\Resources
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\SchCache
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\schemas
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\security
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\ServiceProfiles
Get-Acl : Attempted to perform an unauthorized operation.
At line:7 char:12
+     $acl = Get-Acl -Path $folder_path
+            ~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Get-Acl], UnauthorizedAccessException
    + FullyQualifiedErrorId : System.UnauthorizedAccessException,Microsoft.PowerShell.Commands.GetAclCommand

BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\ServiceState
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\servicing
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\Setup
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\ShellComponents
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\ShellExperiences
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\SKB
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\SoftwareDistribution
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\Speech
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\Speech_OneCore
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\System
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\System32
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\SystemApps
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\SystemResources
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\SysWOW64
BUILTIN\Users : Read, Synchronize : C:\Windows\TAPI
NT AUTHORITY\Authenticated Users : CreateFiles, ReadAndExecute, Synchronize : C:\Windows\Tasks
Get-Acl : Attempted to perform an unauthorized operation.
At line:7 char:12
+     $acl = Get-Acl -Path $folder_path
+            ~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Get-Acl], UnauthorizedAccessException
    + FullyQualifiedErrorId : System.UnauthorizedAccessException,Microsoft.PowerShell.Commands.GetAclCommand

NT AUTHORITY\Authenticated Users : CreateFiles, ReadAndExecute, Synchronize : C:\Windows\Temp
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\TextInput
BUILTIN\Users BUILTIN\Users : Write, Read, Synchronize Write, ReadAndExecute, Synchronize : C:\Windows\tracing
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\twain_32
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\Vss
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\WaaS
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\Web
BUILTIN\Users : ReadAndExecute, Synchronize : C:\Windows\WinSxS
PS C:\Users\NormalUser>
PS C:\Users\NormalUser>
PS C:\Users\NormalUser> date

2020年11月16日 12:55:08


PS C:\Users\NormalUser>